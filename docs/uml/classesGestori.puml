@startuml
skinparam nodesep 100
scale 1400*1400

interface Filtro<T> {
    +controlla(): boolean
}

together {
    +interface Archiviabile<E> {
        +getLista(): List<E>
        +registra(): void
        +rimuovi(): void
        +modifica(): void
        +filtra(): List<E>
    }

    +interface Indicizzabile<K, V> {
        +ottieni(): V
        +contiene(): boolean
    }
}

+class Utente {
}

+class Libro{
}

+class Prestito{
}


+class Biblioteca {
    -archivioUtenti: Indicizzabile<Matricola, Utente>
    -archivioLibri: Indicizzabile<ISBN, Libro>
    -archivioPrestiti: Archiviabile<Prestito>

    +Biblioteca()
    +getArchivioUtenti(): Indicizzabile<Matricola, Utente>
    +getArchivioLibri(): Indicizzabile<ISBN, Libro>
    +getArchivioPrestiti(): Archiviabile<Prestito>

    +salvaFile(): void
    +caricaFile(): Biblioteca {static}
}

+abstract class GestoreOrdinato<E> {
    -lista: List<E>

    +GestoreOrdinato()
}

together {
    +class GestoreLibri extends GestoreOrdinato {
        -indiceISBN: Map<ISBN, Libro> {readOnly}

        +GestoreLibri()
    }


    +class GestoreUtenti extends GestoreOrdinato {
        -indiceMatricole: Map<Matricola, Utente> {readOnly}

        +GestoreUtenti()
    }


    +class GestorePrestiti extends GestoreOrdinato {
        -archivioUtenti: Indicizzabile<Matricola, Utente>
        -archivioLibri: Indicizzabile<ISBN, Libro>

        +GestorePrestiti()
    }
}

GestoreOrdinato -up-|> Archiviabile

Biblioteca --> Archiviabile
Biblioteca --> Indicizzabile

Indicizzabile -right-|> Archiviabile
Archiviabile .right.> Filtro

GestoreLibri .up.|> Indicizzabile
GestoreUtenti .up.|> Indicizzabile

GestorePrestiti -left-> Indicizzabile

GestoreUtenti --> "0..*" Utente
GestoreLibri --> "0..*" Libro
GestorePrestiti --> "0..*" Prestito
@enduml