@startuml
'skinparam classAttributeIconSize 0
skinparam nodesep 100

interface Filtro<T> {
    +controlla(): boolean
}

+abstract class Archivio<E> {
    -collezione: List<E>

    +registra(): void {abstract}
    +rimuovi(): void {abstract}
    +getCollezione(): List<E>
    +filtra(): List<E>
}

+interface CollezioneConChiave<K, V> {
+ottieni(): V
+contiene(): boolean
}

+abstract class Persona{
    -nome: String
    -cognome: String

+Persona()
+getNome(): String
+getCognome(): String
+setNome(): void
+setCognome(): void
+compareTo(): int

}

+class Utente extends Persona{
    -matricola: Matricola
    -email: IndirizzoEmail
    -prestitiAttivi: List<Prestito>

+Utente()
+getMatricola(): Matricola
+getEmail(): IndirizzoEmail
+getPrestitiAttivi(): List<Prestito>
    
+setMatricola(): void
+setEmail(): void
+registraPrestito(): void
+rimuoviPrestito(): void
+compareTo(): int
}

+class Matricola {
    -matricola: String

+Matricola()
+getMatricola(): String
+setMatricola()
+verifica(): boolean {static}
+compareTo(): int
}


+class IndirizzoEmail {
    -indirizzo: String

+IndirizzoEmail()
+getIndirizzoEmail(): String
+setIndirizzo()
+verifica(): boolean {static}
}


+class Libro{
    -titolo: String
    -autori: List<Autore>
    -dataPubblicazione: LocalDate
    -id: ISBN
    -copieDisponibili: int

+Libro()
+getTitolo(): String
+getAutori(): List<Autore>
+getDataPubblicazione(): String
+getISBN(): ISBN
+getCopieDisponibili(): int

+setTitolo(): void
+setAutori(): void
+setDataPubblicazione(): void
+setISBN(): void
+setCopieDisponibili((): void
+aggiungiAutore(): void
+rimuoviAutore(): void
+compareTo(): int
}


+class ISBN {
    -isbn: String

+ISBN()
+getISBN(): String
+setId()
    +verifica(): boolean {static}
+verificaISBN10(): boolean {static}
+verificaISBN13(): boolean {static}
+compareTo(): int
}



+class Autore extends Persona{
}


+class Prestito{
    -matricolaUtente: Matricola
    -idLibro: ISBN
    -statoPrestito: StatoPrestito
    -dataDiScadenza: LocalDate

    +getISBN(): ISBN
    +getMatricola(): Matricola
    +getStatoPrestito(): StatoPrestito
    +getDataDiScadenza(): LocalDate
    +setStatoPrestito(): void
    +isScaduto(): boolean
    +compareTo(): int
}

+enum StatoPrestito{
    ATTIVO,
    RESTITUITO
}


+class Biblioteca {
    -archivioLibri: Archivio<Libri>
    -archivioUtenti: Archivio<Utenti>
    -archivioPrestiti: Archivio<Prestiti>

    +Biblioteca()
    +salvaFile()
    +caricaFile()
}


+class GestoreLibri extends Archivio implements CollezioneConChiave {
    -indiceISBN: Map<ISBN, Libro> {readOnly}
-ord: OrdinatoreLibri {readOnly}

    +GestoreLibri()
}


+class GestoreUtenti extends Archivio implements CollezioneConChiave {
    -indice: Map<Matricola, Utente> {readOnly}
-ord: OrdinatoreUtenti {readOnly}

    +GestoreUtenti()
}


+class GestorePrestiti extends Archivio {
-ord: OrdinatorePrestiti {readOnly}

+GestorePrestiti()
+getStoricoPrestiti(): List<Prestito>
}





Biblioteca --> Archivio
'Biblioteca ..> CollezioneConChiave

Archivio .right.> Filtro

Utente --> "1..3" Prestito
Utente --> Matricola
Utente ---> IndirizzoEmail
Libro ---> "1..*" Autore
Libro --> ISBN
Prestito --> Matricola
Prestito --> ISBN
Prestito --* StatoPrestito

GestoreUtenti --> "1..*" Utente
GestoreLibri --> "1..*" Libro
GestorePrestiti --> "1..*" Prestito
@enduml
